<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Huffman Algorithm: DecompressHuffman.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Huffman Algorithm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DecompressHuffman.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Este programa descomprime un archivo usando el algoritmo de Huffman.  
<a href="#details">More...</a></p>

<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af8b72977f94c79cd969dadf956620758"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="DecompressHuffman_8h.html#af8b72977f94c79cd969dadf956620758">readFrecuencyTable</a> (struct <a class="el" href="structdata.html">data</a> bytesFrecuency[], int *fileSize)</td></tr>
<tr class="separator:af8b72977f94c79cd969dadf956620758"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f02c180b7ccbf5059f3f6fe75391836"><td class="memItemLeft" align="right" valign="top">unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="DecompressHuffman_8h.html#a0f02c180b7ccbf5059f3f6fe75391836">readByteCode</a> (int *fileSize, int *byteFileSize)</td></tr>
<tr class="separator:a0f02c180b7ccbf5059f3f6fe75391836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab38b4faad9e2d10fb63759e4a301c4c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="DecompressHuffman_8h.html#ab38b4faad9e2d10fb63759e4a301c4c3">writeFile</a> (unsigned char *bytesRead, struct <a class="el" href="structnode.html">node</a> *mainTree, const char *file, int byteFileSize, int *fileSize)</td></tr>
<tr class="separator:ab38b4faad9e2d10fb63759e4a301c4c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Este programa descomprime un archivo usando el algoritmo de Huffman. </p>
<dl class="section author"><dt>Author</dt><dd>Victor Torres </dd>
<dd>
Leilani Sotelo </dd>
<dd>
Guillermo Sanchez </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>

<p class="definition">Definition in file <a class="el" href="">DecompressHuffman.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0f02c180b7ccbf5059f3f6fe75391836"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f02c180b7ccbf5059f3f6fe75391836">&#9670;&nbsp;</a></span>readByteCode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char* readByteCode </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>fileSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>byteFileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lee el archivo comprimido. Obtenemos el tamaño del archivo comprimido y los bytes que lo componen, esto lo guardamos en una cadena.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileSize</td><td>direccion de memoria de la variable del tamaño del archivo </td></tr>
    <tr><td class="paramname">byteFileSize</td><td>direccion de memoria de la variable del tamaño del archivo comprimido </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>el arreglo donde estan los bytes leidos </dd></dl>

</div>
</div>
<a id="af8b72977f94c79cd969dadf956620758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8b72977f94c79cd969dadf956620758">&#9670;&nbsp;</a></span>readFrecuencyTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void readFrecuencyTable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdata.html">data</a>&#160;</td>
          <td class="paramname"><em>bytesFrecuency</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>fileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lee y guarda la tabla de frecuencias. A partir de la tabla de frecuencia generada al comprimir el archivo, leemos las veces que se se repitio cada bit, ademas al principio del archivo leemos el tamaño original del archivo, las frecuencias las guardamos en un arreglo, con su respectivo byte aplicando hash, donde la llave es el byte.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bytesFrecuency</td><td>arreglo donde esta la frecuencia de repeticion de bits </td></tr>
    <tr><td class="paramname">fileSize</td><td>direccion de memoria de la variable del tamaño del archivo </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                                                                    {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordtype">int</span> byte, frecuency, i = 0;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    FILE* frecuencyTable;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="comment">//Abrimos y verificamos que si se abrio correctamente</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    frecuencyTable = fopen(<span class="stringliteral">&quot;frecuencyTable.txt&quot;</span>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordflow">if</span>(frecuencyTable == NULL){</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        puts(<span class="stringliteral">&quot;The file could not be opened.\n&quot;</span>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        exit(1);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    }</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//Leemos el tamaño de archivo y las veces que se repite cada byte</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordflow">while</span>(!feof(frecuencyTable)){</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">if</span>(i == 0)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        fscanf(frecuencyTable, <span class="stringliteral">&quot;%d&quot;</span>, fileSize);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    fscanf(frecuencyTable, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<span class="keywordtype">byte</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    fscanf(frecuencyTable, <span class="stringliteral">&quot;%d&quot;</span>, &amp;frecuency);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    bytesFrecuency[byte].<a class="code" href="structdata.html#af27bef4b0c09016974738690d89009f4">byte</a> =  byte;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    bytesFrecuency[byte].frequency = frecuency;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    i++;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    fclose(frecuencyTable);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div>
<div class="ttc" id="astructdata_html_af27bef4b0c09016974738690d89009f4"><div class="ttname"><a href="structdata.html#af27bef4b0c09016974738690d89009f4">data::byte</a></div><div class="ttdeci">int byte</div><div class="ttdef"><b>Definition:</b> HuffmanStructures.h:41</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00041">data::byte</a>.</p>

</div>
</div>
<a id="ab38b4faad9e2d10fb63759e4a301c4c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab38b4faad9e2d10fb63759e4a301c4c3">&#9670;&nbsp;</a></span>writeFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeFile </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>bytesRead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnode.html">node</a> *&#160;</td>
          <td class="paramname"><em>mainTree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>byteFileSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>fileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Escribimos el archivo original a partir de la decodificacion de los bytes. Vamos recorriendo bit a bit de los bytes leidos en el archivo comprimido, y recorremos el arbol de Huffman, en base a esto nos devuelve tanto la la posicion en bits de 0 a 7 en la que se quedo, como en la variable byteToWrite, el byte correspondiente a cada cadena de bits, una ves que tenemos esto, escribimos en el archivo el byte correspondiente.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bytesRead</td><td>el apuntador al inicio de la cadena de los bytes leidos </td></tr>
    <tr><td class="paramname">mainTree</td><td>el arbol de Huffman donde unimos todos los bytes y su frecuencia </td></tr>
    <tr><td class="paramname">file</td><td>el nombre del archivo en el que escribiremos </td></tr>
    <tr><td class="paramname">byteFileSize</td><td>el tamaño del archivo comprimido </td></tr>
    <tr><td class="paramname">fileSize</td><td>apuuntador de la variable del tamaño del archivo que escribiremos </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                                                                                                  {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    FILE* finalFile;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//Abrimos y verificamos que si se abrio correctamente</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    finalFile = fopen(file, <span class="stringliteral">&quot;wb+&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span>(finalFile == NULL){</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        puts(<span class="stringliteral">&quot;The file could not be opened.\n&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        exit(1);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">//Variables para escribir en el archivo</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">int</span> i, posInBits = 7, bytesWritten = 0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> byteToWrite;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//Leemos los bits extra que escribimos</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">int</span> bitsExtraWritten = bytesRead[byteFileSize-1];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; byteFileSize - 1 &amp;&amp; bytesWritten &lt; (*fileSize);){</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    posInBits = <a class="code" href="HuffmanStructures_8h.html#a9f60f86711915027587cc7e51824530f">getCharacters</a>(mainTree, bytesRead , &amp;i, posInBits, &amp;byteToWrite);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">//escribimos el byte correspondiente a los bits</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    fwrite(&amp;byteToWrite, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>), 1, finalFile);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    bytesWritten++;<span class="comment">//conteo para no escribir de mas</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">//Cuidamos no escribir los bits extra que escribimos al comprimir</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span>(i == (*fileSize) - 2 &amp;&amp; 7 - posInBits == bitsExtraWritten)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        bytesWritten++;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//Checamos que no nos desbordamos de posicion de bits</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span>(posInBits &lt; 0){</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        posInBits = 7;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        i++;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    (*fileSize) = bytesWritten;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    fclose(finalFile);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="ttc" id="aHuffmanStructures_8h_html_a9f60f86711915027587cc7e51824530f"><div class="ttname"><a href="HuffmanStructures_8h.html#a9f60f86711915027587cc7e51824530f">getCharacters</a></div><div class="ttdeci">int getCharacters(struct node *HuffmanTree, unsigned char *cadena, int *posInString, int posInBits, unsigned char *byteToWrite)</div><div class="ttdef"><b>Definition:</b> HuffmanStructures.c:48</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00048">getCharacters()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
