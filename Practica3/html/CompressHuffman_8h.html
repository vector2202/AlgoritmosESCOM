<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Huffman Algorithm: CompressHuffman.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Huffman Algorithm
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CompressHuffman.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Este programa comprime un archivo usando el algoritmo de Huffman.  
<a href="#details">More...</a></p>

<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4f37515796753c21cf823d11da2bdfde"><td class="memItemLeft" align="right" valign="top">unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CompressHuffman_8h.html#a4f37515796753c21cf823d11da2bdfde">readFile</a> (const char *fileToOpen, struct <a class="el" href="structdata.html">data</a> bytesFrecuency[], int *fileSize)</td></tr>
<tr class="separator:a4f37515796753c21cf823d11da2bdfde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96ba159a684989b67318a892110b035c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CompressHuffman_8h.html#a96ba159a684989b67318a892110b035c">writeFrecuenyTable</a> (struct <a class="el" href="structdata.html">data</a> bytesFrecuency[], int fileSize)</td></tr>
<tr class="separator:a96ba159a684989b67318a892110b035c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b3774376c394e71272ececd33669d9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="CompressHuffman_8h.html#a5b3774376c394e71272ececd33669d9c">writeBinaryCode</a> (unsigned char *bytesRead, struct <a class="el" href="structnode.html">node</a> *mainTree, struct <a class="el" href="structbits.html">bits</a> *bytesCode, int fileSize, int *compressedFileSize)</td></tr>
<tr class="separator:a5b3774376c394e71272ececd33669d9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Este programa comprime un archivo usando el algoritmo de Huffman. </p>
<dl class="section author"><dt>Author</dt><dd>Victor Torres </dd>
<dd>
Leilani Sotelo </dd>
<dd>
Guillermo Sanchez </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>

<p class="definition">Definition in file <a class="el" href="">CompressHuffman.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4f37515796753c21cf823d11da2bdfde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f37515796753c21cf823d11da2bdfde">&#9670;&nbsp;</a></span>readFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char* readFile </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fileToOpen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdata.html">data</a>&#160;</td>
          <td class="paramname"><em>bytesFrecuency</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>fileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lee los bytes del archivo de entrada y lo guarda en una cadena. Esta funcion lee un archivo de entrada, calcula el tamaño del archivo, lee los bytes del archivo y los guarda en una cadena ademas registra la frecuencia de aparicion de cada byte aplicando el concepto de Hash, donde la llave es el valor en decimal del byte que leimos</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fileToOpen</td><td>nombre del archivo a abrir </td></tr>
    <tr><td class="paramname">bytesFrecuency</td><td>arreglo donde esta la frecuencia de repeticion de bits </td></tr>
    <tr><td class="paramname">fileSize</td><td>direccion de memoria de la variable del tamaño del archivo </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>el apuntador de la cadena de los bytes leidos </dd></dl>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    FILE *file;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">//Abrimos y verificamos que si se abrio correctamente</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    file = fopen(fileToOpen, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">if</span> (file == NULL)</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        puts(<span class="stringliteral">&quot;The file could not be opened.\n&quot;</span>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        exit(1);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">//Obtenemos el tamaño del archivo.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    fseek(file, 0L, SEEK_END);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    (*fileSize) = ftell(file);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    rewind(file);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">//Reservamos memoria para la cadena de bytes leidos</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *bytesRead = malloc((*fileSize) * <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//Guardamos los bytes leidos y su frecuencia con su valor en decimal</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; (*fileSize); i++)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        fread(&amp;c, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>), 1, file);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        bytesRead[i] = c;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        bytesFrecuency[c].<a class="code" href="structdata.html#af27bef4b0c09016974738690d89009f4">byte</a> = c;    <span class="comment">// Enmascaramiento</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        bytesFrecuency[c].frequency++; <span class="comment">// frecuencia de apariciones</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    fclose(file);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">return</span> bytesRead;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="ttc" id="astructdata_html_af27bef4b0c09016974738690d89009f4"><div class="ttname"><a href="structdata.html#af27bef4b0c09016974738690d89009f4">data::byte</a></div><div class="ttdeci">int byte</div><div class="ttdef"><b>Definition:</b> HuffmanStructures.h:41</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00041">data::byte</a>.</p>

</div>
</div>
<a id="a5b3774376c394e71272ececd33669d9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b3774376c394e71272ececd33669d9c">&#9670;&nbsp;</a></span>writeBinaryCode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeBinaryCode </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>bytesRead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnode.html">node</a> *&#160;</td>
          <td class="paramname"><em>mainTree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbits.html">bits</a> *&#160;</td>
          <td class="paramname"><em>bytesCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fileSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>compressedFileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Escribe la codificacion de Huffman de cada byte correspondiente. En un archivo llamado byteCode.dat, escribe el equivalente de la codificacion de Huffman de los bytes leidos del archivo original, esto lo hace mediante corrimientos de bits y con una bandera llamada sizeByteToWrite que nos indica si tenemos los 8 bits para escribir en el .dat, si no la guarda y mediante corrimeintos la suma con la codificacion del siguiente byte, en el ultimo byte del .dat, escribe cuantos bits extra escribimos que no corresponden a la codificacion de Huffman</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bytesRead</td><td>el apuntador al inicio de la cadena de los bytes leidos </td></tr>
    <tr><td class="paramname">mainTree</td><td>el arbol de Huffman donde unimos todos los bytes y su frecuencia </td></tr>
    <tr><td class="paramname">frecuencyTable</td><td>un arreglo donde temenos la codificacion de Huffman de los bytes </td></tr>
    <tr><td class="paramname">fileSize</td><td>el tamaño del archivo original </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordtype">int</span> i, j, bitsExtraWritten = 0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    FILE *binaryCode;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">//Abrimos y verificamos que si se abrio correctamente</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    binaryCode = fopen(<span class="stringliteral">&quot;byteCode.dat&quot;</span>, <span class="stringliteral">&quot;wb+&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (binaryCode == NULL)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        puts(<span class="stringliteral">&quot;The file could not be opened.\n&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        exit(1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">//Variables para poder escribir los bits</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">int</span> bitsSize, sizeByteToWrite, tempSize = 0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbits.html">bits</a>, tempBits, tempBits2, tempBitsAux;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> byteToWrite;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; fileSize; i++)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        bitsSize = bytesCode[bytesRead[i]].<a class="code" href="structbits.html#a15a0d838e9d402ead452a092c4f27e57">sizeBits</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="structbits.html">bits</a> = bytesCode[bytesRead[i]].<a class="code" href="structbits.html#a3e6347128690b18f31f4c12ba62f7796">bits</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="comment">//Checamos si hay bits que no escribimos</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">if</span> (tempSize != 0)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <a class="code" href="structbits.html">bits</a> = (tempBits &lt;&lt; bitsSize) + <a class="code" href="structbits.html">bits</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            bitsSize += tempSize;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            tempBits = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            tempSize = 0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">//Podemos escribir o no el byte?</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span> (bitsSize &gt;= 8)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordflow">if</span> (bitsSize &gt; 8)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="comment">//Tenemos mas bits de los que podemos escribir, hay que reducir</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="comment">//Guardamos lo que no podemos escribir en una variable temporal</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                tempSize = bitsSize - 8;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">for</span> (j = 0; j &lt; tempSize; j++)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    tempBits2 = (CONSULTARBIT(<a class="code" href="structbits.html">bits</a>, j)) &lt;&lt; j;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    tempBits = tempBits2 + tempBits;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="comment">//ajustamos los bits para poder escribir los primeros 8</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="structbits.html">bits</a> = <a class="code" href="structbits.html">bits</a> &gt;&gt; tempSize;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            byteToWrite = <a class="code" href="structbits.html">bits</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            sizeByteToWrite = 8; <span class="comment">// Podemos escribir en el .dat</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            tempBits = <a class="code" href="structbits.html">bits</a>;     <span class="comment">// Guardamos en una variable temporal</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            tempSize = bitsSize; <span class="comment">// lo que no pudimos escribir</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// Hay bytes por escribir?</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (sizeByteToWrite == 8)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            sizeByteToWrite = 0; <span class="comment">//Escribimos el byte</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            fwrite(&amp;byteToWrite, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>), 1, binaryCode);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">//Checamos que no se desborde tempBits</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">while</span> (tempSize &gt;= 8)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="comment">//Ajustamos tempsize para poder escribir los primeros 8</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            tempSize = tempSize - 8;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            tempBitsAux = tempBits;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <a class="code" href="structbits.html">bits</a> = tempBits &gt;&gt; tempSize;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            tempBits = 0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="comment">//Guardamos el exceso en una variable temporal</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; tempSize; j++)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                tempBits2 = ((CONSULTARBIT(tempBitsAux, j)) &lt;&lt; j);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                tempBits = tempBits2 + tempBits;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            byteToWrite = <a class="code" href="structbits.html">bits</a>; <span class="comment">// Escribimos el byte</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            fwrite(&amp;byteToWrite, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>), 1, binaryCode);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">//Faltaron bits por escribir?</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> (tempBits != 0)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        tempBits = (tempBits &lt;&lt; (8 - tempSize));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        byteToWrite = tempBits;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        fwrite(&amp;byteToWrite, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>), 1, binaryCode);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        bitsExtraWritten = 8 - tempSize; <span class="comment">//Bits extra escritos</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">//En el ultimo byte, indica cuantos bits extra escribimos</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    byteToWrite = bitsExtraWritten;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    fwrite(&amp;byteToWrite, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>), 1, binaryCode);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">//Obtenemos el tamaño del archivo comprimido</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    fseek(binaryCode, 0L, SEEK_END);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    (*compressedFileSize) = ftell(binaryCode);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    rewind(binaryCode);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">//Cerrar el archivo</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    fclose(binaryCode);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="ttc" id="astructbits_html"><div class="ttname"><a href="structbits.html">bits</a></div><div class="ttdoc">Almacena el byte correspondiente, su tamaño y sus bits de la codificacion de Huffman.</div><div class="ttdef"><b>Definition:</b> HuffmanStructures.h:25</div></div>
<div class="ttc" id="astructbits_html_a15a0d838e9d402ead452a092c4f27e57"><div class="ttname"><a href="structbits.html#a15a0d838e9d402ead452a092c4f27e57">bits::sizeBits</a></div><div class="ttdeci">int sizeBits</div><div class="ttdef"><b>Definition:</b> HuffmanStructures.h:27</div></div>
<div class="ttc" id="astructbits_html_a3e6347128690b18f31f4c12ba62f7796"><div class="ttname"><a href="structbits.html#a3e6347128690b18f31f4c12ba62f7796">bits::bits</a></div><div class="ttdeci">int bits</div><div class="ttdef"><b>Definition:</b> HuffmanStructures.h:28</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="#l00028">bits::bits</a>, and <a class="el" href="#l00027">bits::sizeBits</a>.</p>

</div>
</div>
<a id="a96ba159a684989b67318a892110b035c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96ba159a684989b67318a892110b035c">&#9670;&nbsp;</a></span>writeFrecuenyTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeFrecuenyTable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structdata.html">data</a>&#160;</td>
          <td class="paramname"><em>bytesFrecuency</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Escribe la tabla de frecuencias y el tamaño del archivo leido. Escribe en un txt, el tamaño original del archivo ademas de el valor en decimal de cada bit que aparecio seguida de las veces que aparecio solo si la frecuencia de aparicion es mayor a 0, esto es, que el byte esta en el archivo original</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">symbolFrecuency</td><td>arreglo donde esta la frecuencia de repeticion de bits </td></tr>
    <tr><td class="paramname">fileSize</td><td>direccion de memoria de la variable del tamaño del archivo </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    FILE *frecuencyTable;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">//Abrimos y verificamos que si se abrio correctamente</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    frecuencyTable = fopen(<span class="stringliteral">&quot;frecuencyTable.txt&quot;</span>, <span class="stringliteral">&quot;wt+&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (frecuencyTable == NULL)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        puts(<span class="stringliteral">&quot;The file could not be opened.\n&quot;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        exit(1);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">//Escribimos el tamaño original al inicio del txt</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    fprintf(frecuencyTable, <span class="stringliteral">&quot;%d\n&quot;</span>, fileSize);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 256; i++)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span> (bytesFrecuency[i].frequency &gt; 0) <span class="comment">//Si el simbolo aparecio en el archivo, escribelo</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            fprintf(frecuencyTable, <span class="stringliteral">&quot;%d %d\n&quot;</span>, bytesFrecuency[i].<span class="keywordtype">byte</span>, bytesFrecuency[i].frequency);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    fclose(frecuencyTable);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
